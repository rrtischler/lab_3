%function [Y]=reverbSX(X,FS,d, att)
    %   Y   = espectro do sinal de saída
    %   X   = espectro do sinal de entrada
    %   FS  = frequencia de amostragem
    %   att = atenuacao (0,1)
    %   d   = offset em ms

X = [0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;-0.390625000000000;-0.414062500000000;-0.289062500000000;
    -0.117187500000000;-0.0312500000000000;-0.0312500000000000;-0.0625000000000000;-0.0234375000000000;
    0.0234375000000000;0.0703125000000000;0.109375000000000;0.156250000000000;0.203125000000000;
    0.242187500000000;0.218750000000000;0;-0.164062500000000;-0.140625000000000;-0.0156250000000000;
    0.195312500000000;0.320312500000000;0.320312500000000;0.242187500000000;0.242187500000000;
    0.265625000000000;0.304687500000000;0.289062500000000;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0];
d = 200;
att = 0.5;
FS = 16000;

% criacao do filtro
d = d/1000;
del = round(d*FS);
b = zeros(1 , 4*del);
b(1) = 1;
a = 1;
b(4*del) = att;
b(3*del) = att + 0.07;
b(2*del) = att + 0.07;
b(del) = att + 0.08;

sys = tf(b,a);
% filtragem
Y = filter(b,a,X);

%end
